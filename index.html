<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Biblioteca Online</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      overflow-x: hidden;
      font-family: 'Arial', sans-serif;
      background: linear-gradient(135deg, #0d0717, #1a0f2e);
      color: #fff;
    }
	
header {
  text-align: center;
  padding: 40px 20px; /* padding apenas para o cabe√ßalho */
}
    header { text-align:center; padding:20px 20px; }
    header h1 { font-size:2.5rem; margin-bottom:10px; }
    header p { font-size:1.2rem; opacity:0.8; }

    /* CARROSSEL */
    .carousel-container {
      position: relative;
      width: 90%;
      max-width: 900px;
      margin: 40px auto;
      overflow: hidden;
    }
    .carousel-track {
      display: flex;
      transition: transform 0.5s ease;
      padding: 20px 0;
      box-sizing: border-box;
    }
    .carousel-item {
      width: 160px;
      height: 240px;
      margin: 0 10px;
      flex-shrink: 0;
      opacity: 0.6;
      transform: scale(0.9);
      transition: all 0.5s ease;
      cursor: pointer;
      position: relative;
      border: 2px solid transparent;
      border-radius: 10px;
    }
    .carousel-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 10px;
      display: block;
    }
    .carousel-item.active { opacity: 1; transform: scale(1); }
    .carousel-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(124,58,174,0.8);
      color: #fff;
      border: none;
      font-size: 2em;
      padding: 5px 10px;
      cursor: pointer;
      border-radius: 5px;
      z-index: 10;
    }
    #prev { left: 10px; }
    #next { right: 10px; }

    /* LISTA DE LIVROS */
    .container { width:90%; max-width:1000px; margin:30px auto; }
    .library-list { display:flex; flex-direction:column; gap:20px; }
    .livro {
      display:flex;
      background: rgba(255,255,255,0.05);
      border-radius:16px;
      padding:15px;
      width:100%;
      min-height:160px;
      align-items:flex-start;
      gap:15px;
      box-shadow:0 4px 12px rgba(0,0,0,0.3);
      transition:transform 0.3s ease, border-color 0.3s ease;
      position: relative;
    }
    .livro:hover { transform:translateY(-3px); }
    .livro img {
      width:110px;
      height:160px;
      object-fit:cover;
      border-radius:8px;
      flex-shrink:0;
    }
    .livro-info { flex:1; display:flex; flex-direction:column; justify-content:center; }
    .livro-info h2 { margin-top:0; margin-bottom:6px; font-size:1.3em; }
    .livro-info p { margin-bottom:10px; line-height:1.4; opacity:0.9; }
    .botao {
      display:inline-block;
      padding:8px 10px;
      background:#7c3aed;
      color:white;
      text-decoration:none;
      border-radius:8px;
      font-weight:bold;
      transition: background 0.3s;
    }
    .botao:hover { background:#5b21b6; }

    /* Contador individual dos livros */
    .livro-views {
      position: absolute;
      top: 10px;
      right: 10px;
      display:flex;
      align-items:center;
      gap:5px;
      font-size: 0.9rem;
    }
    .livro-views img { width:18px; height:18px; }

    /* Borda piscando efeito hacker */
    @keyframes flashBorder {
      0%,100% { border-color: #7c3aed; }
      50% { border-color: #00ff00; }
    }
    .flash { animation: flashBorder 1s ease 0s 3; }

    /* Contador total */
    #total-visits {
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      font-size:1.2rem;
      margin:15px auto;
    }
    #total-visits img { width:24px; height:24px; }

    /* Painel admin hacker */
    #adminPanel {
      position:fixed;
      top:50%;
      left:50%;
      transform:translate(-50%,-50%);
      background:#0d0d0d;
      padding:20px;
      border-radius:12px;
      z-index:999;
      color:#0f0;
      display:none;
      max-height:80vh;
      overflow-y:auto;
      width:90%;
      max-width:500px;
      box-shadow: 0 0 20px #00ff00, 0 0 40px #0f0, 0 0 60px #0f0;
      border: 2px solid #0f0;
      animation: pulseBorder 2s infinite;
    }
    @keyframes pulseBorder {
      0%,100% { box-shadow: 0 0 20px #00ff00, 0 0 40px #0f0, 0 0 60px #0f0; }
      50% { box-shadow: 0 0 40px #ff0000, 0 0 60px #ff0, 0 0 80px #0ff; }
    }
    #adminPanel h2 { text-align:center; margin-bottom:15px; }
    .admin-book {
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:10px;
      background:rgba(0,255,0,0.1);
      padding:8px 10px;
      border-radius:8px;
    }
    .admin-book span { font-weight:bold; }
    .admin-book input {
      width:50px;
      margin-left:5px;
      padding:2px 4px;
      border-radius:4px;
      border:1px solid #0f0;
      background:#000;
      color:#0f0;
      text-align:center;
    }
    .admin-book button {
      background:#0f0;
      border:none;
      color:black;
      padding:4px 8px;
      border-radius:5px;
      cursor:pointer;
      margin-left:4px;
      font-weight:bold;
      transition: all 0.3s;
    }
    .admin-book button:hover { background:#ff0; color:#000; }
    #closeAdmin {
      position:absolute;
      top:10px;
      right:15px;
      background:#0f0;
      color:black;
      padding:4px 8px;
      border:none;
      border-radius:5px;
      cursor:pointer;
    }

    /* RODAP√â */
    footer { background:#1a0f2e; text-align:center; padding:25px 20px; margin-top:50px; color:#aaa; }
    footer p { margin:5px 0; }
    footer a { color:#7c3aed; text-decoration:none; margin:0 8px; }
    footer a:hover { text-decoration:underline; }

    /* Mobile ajustes */
    @media(max-width:768px){
      .carousel-item { width:140px; height:210px; margin:0 8px; }
      .livro img { width:90px; height:130px; }
      .livro-views img { width:14px; height:14px; }
      #total-visits img { width:18px; height:18px; }
    }
	/* ===== PESQUISA ===== */
#search-icon {
  position: fixed;
  top: 25px;
  right: 25px;
  background: none;
  padding: 10px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease;
  z-index: 1000;
  box-shadow: 0 0 12px rgba(0,0,0,0.3);
  display: flex;
  align-items: center;
  justify-content: center;
}

#search-icon svg {
  stroke: white;       /* cor do √≠cone */
  width: 28px;         /* tamanho */
  height: 28px;
  transition: stroke 0.3s;
}

#search-icon:hover svg {
  stroke: #aaa;        /* muda cor ao passar o mouse */
}

#search-bar {
  position: fixed;
  top: 25px;
  right: 75px;
  background: rgba(255,255,255,0.1);
  border-radius: 30px;
  overflow: hidden;
  width: 0;
  height: 40px;
  transition: width 0.4s ease;
  display: flex;
  align-items: center;
  z-index: 999;
}
#search-bar.active {
  width: 250px;
  padding: 0 10px;
}
#search-bar input {
  flex: 1;
  border: none;
  background: transparent;
  color: white;
  font-size: 1rem;
  outline: none;
  padding-left: 10px;
}

/* ===== MENU DE CATEGORIAS ===== */
#category-btn {
  position: fixed;
  top: 25px;
  left: 25px;
  background: none;
  color: white;
  padding: 10px 14px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
  z-index: 1000;
  transition: background 0.3s ease;
}
#category-btn:hover {
  background: #5b21b6;
}

#category-menu {
  position: fixed;
  top: 0;
  left: -260px;
  width: 240px;
  height: 100%;
  background: rgba(26,15,46,0.97);
  color: white;
  padding: 30px 20px;
  transition: left 0.4s ease;
  z-index: 999;
  box-shadow: 3px 0 12px rgba(0,0,0,0.4);
}
#category-menu.active {
  left: 0;
}
#category-menu h3 {
  margin-top: 0;
  text-align: center;
  margin-bottom: 15px;
  border-bottom: 2px solid #7c3aed;
  padding-bottom: 8px;
}
#category-menu ul {
  list-style: none;
  padding: 0;
}
#category-menu li {
  padding: 10px;
  margin-bottom: 5px;
  background: rgba(255,255,255,0.1);
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.3s;
}
#category-menu li:hover {
  background: #7c3aed;
}

/* Mobile */
@media (max-width: 600px) {
  #search-bar.active { width: 180px; }
}
/* ===== GRID DE LIVROS ===== */
#search-results {
  display: none;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); /* colunas flex√≠veis */
  gap: 30px; /* espa√ßo fixo entre cards */
  padding: 110px 100px; /* padding apenas dentro do grid */
  justify-items: center; /* centraliza cards horizontalmente */
  align-items: start; /* cards come√ßam no topo da coluna */
  animation: fadeIn 0.5s ease;
}

/* Cards dentro do grid */
.grid-resultados .card-livro {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border-radius: 12px;
  padding: 15px;
  width: 180px; /* largura fixa */
  height: 300px; /* altura fixa para manter alinhamento */
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  text-align: center;
  color: white;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  transition: transform 0.3s ease, background 0.3s ease;
  cursor: pointer;
}
.grid-resultados .card-livro img {
  width: 100%;
  height: 260px; /* altura fixa da imagem */
  object-fit: cover;
  border-radius: 8px;
  margin-bottom: 10px;
}
.grid-resultados .card-livro h4 {
  margin: 0;
  font-size: 1rem;
  color: #fff;
  flex-grow: 1; /* for√ßa o t√≠tulo ocupar espa√ßo */
}

/* ===== RESPONSIVIDADE ===== */
@media (max-width: 900px) {
  #search-results {
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    padding: 20px 0;
  }
  .grid-resultados .card-livro {
    width: 140px;
    height: 250px;
  }
  .grid-resultados .card-livro img {
    height: 180px;
  }
}
/* Anima√ß√£o */
@keyframes fadeIn {
  from {opacity: 0; transform: translateY(15px);}
  to {opacity: 1; transform: translateY(0);}
}

  </style>

</head>
<body>
<!-- √çcone de busca fixo -->
<div id="search-icon">
  <svg id="icon-svg" width="30" height="30" viewBox="0 0 64 64">
    <!-- Lupa -->
    <circle id="lens" cx="27" cy="27" r="16" stroke="white" stroke-width="4" fill="none"/>
    <line id="handle" x1="41" y1="41" x2="55" y2="55" stroke="white" stroke-width="4"/>
    <!-- Casinha (inicialmente invis√≠vel) -->
    <polygon id="house" points="16,32 32,16 48,32 48,48 16,48" fill="white" opacity="0"/>
  </svg>
</div>



<!-- Barra de pesquisa -->
<div id="search-bar">
  <input type="text" id="search-input" placeholder="Pesquisar livros...">
</div>
<!-- Grid de resultados da pesquisa -->
<div id="search-results" class="grid-resultados"></div>

<!-- Bot√£o e menu de categorias -->
<div id="category-btn">‚ò∞ Categoria</div>
<div id="category-menu">
  <h3>Categorias</h3>
  <ul>
    <li data-category="todos">Todos</li>
    <li data-category="motiva√ß√£o">Motiva√ß√£o</li>
    <li data-category="autoajuda">Autoajuda</li>
    <li data-category="psicologia">Psicologia</li>
    <li data-category="manipula√ß√£o">Manipula√ß√£o</li>
    <li data-category="poder">Poder</li>
    <li data-category="estrat√©gia">Estrat√©gia</li>
  </ul>
</div>

  <header>
    <h1>üìö Biblioteca Online</h1>
    <p>Uma cole√ß√£o de livros digitais para quem busca crescimento pessoal, motiva√ß√£o e transforma√ß√£o.</p>
  </header>

  <div class="container">
    <!-- CARROSSEL -->
    <div class="carousel-container" id="carousel-container">
      <button class="carousel-btn" id="prev">&#10094;</button>
      <div class="carousel-track" id="carousel-track">
        <div class="carousel-item" data-book="invisivel">
          <a href="livros/Liberte-se do inimigo invis√≠vel.html"><img src="livros/img/invisivel.png" alt="Liberte-se do inimigo invis√≠vel"></a>
        </div>
        <div class="carousel-item" data-book="potencial">
          <a href="livros/destravando.html"><img src="livros/img/potencial.png" alt="Destravando Seu Potencial"></a>
        </div>
        <div class="carousel-item" data-book="48leis">
          <a href="livros/48-leis-do-poder.html"><img src="livros/img/48.png" alt="48 Leis do Poder"></a>
        </div>
        <!-- NOVO LIVRO -->
        <div class="carousel-item" data-book="fbi">
          <a href="livros/fbi.html"><img src="livros/img/fbi.png" alt="Manual de Persuas√£o da FBI"></a>
        </div>  
         <div class="carousel-item" data-book="influenciar-pessoas">
          <a href="livros/influenciar-pessoas.html"><img src="livros/img/influenciar-pessoas.png" alt="Como fazer amigos e influencair pessoas"></a>
        </div>
        <div class="carousel-item" data-book="poder-manipula√ßao">
          <a href="livros/Poder-Manipula√ß√£o.html"><img src="livros/img/poder-manipula√ßao.png" alt="poder $ manipula√ß√£o Jacob Petry"></a>
        </div>
        <div class="carousel-item" data-book="manipula√ßao-oculta">
          <a href="livros/Manipulacao-oculta.html"><img src="livros/img/manipula√ßao-oculta.png" alt="manipula√ßao oculta"></a>
        </div>
        <div class="carousel-item" data-book="engenharia-social">
          <a href="livros/engenharia-social.html"><img src="livros/img/engenharia-social.png" alt="engenharia social"></a>
        </div>
        <div class="carousel-item" data-book="sedu√ßao-maquiavelica">
          <a href="livros/seducao-maquiavelica.html"><img src="livros/img/sedu√ßao-maquiavelica.png" alt="sedu√ßao maquiavelica"></a>
        </div>
      </div>
      <button class="carousel-btn" id="next">&#10095;</button>
    </div>

    <!-- LISTA DE LIVROS -->
    <div class="library-list">
      <div class="livro" data-book="invisivel">
        <img src="livros/img/invisivel.png" alt="Liberte-se do inimigo invis√≠vel">
        <div class="livro-info">
          <h2>Liberte-se do inimigo invis√≠vel</h2>
          <p>Baseado em ‚ÄúMais Esperto que o Diabo‚Äù, este livro ajuda a identificar obst√°culos invis√≠veis e liberar seu potencial.</p>
          <a href="livros/Liberte-se do inimigo invis√≠vel.html" class="botao">Ver detalhes</a>
        </div>
        <div class="livro-views"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/visible.png"/><span>0</span></div>
      </div>
      <div class="livro" data-book="potencial">
        <img src="livros/img/potencial.png" alt="Destravando Seu Potencial">
        <div class="livro-info">
          <h2>Destravando Seu Potencial</h2>
          <p>Um guia pr√°tico para desbloquear sua mente e alcan√ßar seus objetivos.</p>
          <a href="livros/destravando.html" class="botao">Ver detalhes</a>
        </div>
        <div class="livro-views"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/visible.png"/><span>0</span></div>
      </div>
      <div class="livro" data-book="48leis">
        <img src="livros/img/48.png" alt="48 Leis do Poder">
        <div class="livro-info">
          <h2>48 Leis do Poder</h2>
          <p>Domine as regras do poder e influencie pessoas de forma estrat√©gica.</p>
          <a href="livros/48-leis-do-poder.html" class="botao">Ver detalhes</a>
        </div>
        <div class="livro-views"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/visible.png"/><span>0</span></div>
      </div>
      <!-- NOVO LIVRO -->
      <div class="livro" data-book="fbi">
        <img src="livros/img/fbi.png" alt="Manual de Persuas√£o da FBI">
        <div class="livro-info">
          <h2>Manual de Persuas√£o da FBI</h2>
          <p>Aprenda t√©cnicas de persuas√£o utilizadas por agentes do FBI para influenciar decis√µes e conduzir entrevistas com sucesso.</p>
          <a href="livros/fbi.html" class="botao">Ver detalhes</a>
        </div>
        <div class="livro-views"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/visible.png"/><span>0</span></div>
      </div>
      <div class="livro" data-book="influenciar-pessoas">
        <img src="livros/img/influenciar-pessoas.png" alt="Manual de Persuas√£o da FBI">
        <div class="livro-info">
         <h2>Como Fazer Amigos e Influenciar Pessoas</h2>
         <p>Descubra estrat√©gias comprovadas para conquistar amizades verdadeiras, fortalecer conex√µes e influenciar pessoas de forma positiva em qualquer ambiente.</p>
         <a href="livros/influenciar-pessoas.html" class="botao">Ver detalhes</a>
        </div>
        <div class="livro-views"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/visible.png"/><span>0</span></div>
      </div>
 <!-- Poder & Manipula√ß√£o ‚Äì Jacob Petry -->
      <div class="livro" data-book="poder-manipulacao">
        <img src="livros/img/poder-manipula√ßao.png" alt="Poder & Manipula√ß√£o">
        <div class="livro-info">
        <h2>Poder & Manipula√ß√£o ‚Äì Jacob Petry</h2>
        <p>Aprenda a dominar t√©cnicas de persuas√£o, manipula√ß√£o psicol√≥gica e influ√™ncia estrat√©gica de forma avan√ßada.</p>
        <a href="livros/Poder-Manipula√ß√£o.html" class="botao">Ver detalhes</a>
      </div>
        <div class="livro-views"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/visible.png"/><span>0</span></div>
      </div>

<!-- Engenharia Social ‚Äì A Arte de Influenciar e N√£o Ser Influenciado -->
      <div class="livro" data-book="engenharia-social">
        <img src="livros/img/engenharia-social.png" alt="Engenharia Social">
        <div class="livro-info">
        <h2>Engenharia Social ‚Äì Jacob Petry</h2>
        <p>Descubra como influenciar pessoas de forma √©tica e evitar ser manipulado atrav√©s de t√©cnicas de engenharia social.</p>
        <a href="livros/engenharia-social.html" class="botao">Ver detalhes</a>
      </div>
      <div class="livro-views"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/visible.png"/><span>0</span></div>
      </div>

<!-- Manipula√ß√£o Oculta -->
    <div class="livro" data-book="manipulacao-oculta">
      <img src="livros/img/manipula√ßao-oculta.png" alt="Manipula√ß√£o Oculta">
      <div class="livro-info">
      <h2>Manipula√ß√£o Oculta</h2>
      <p>Aprenda t√©cnicas secretas de manipula√ß√£o e persuas√£o, com foco em psicologia e percep√ß√£o das pessoas.</p>
      <a href="livros/manipulacao-oculta.html" class="botao">Ver detalhes</a>
    </div>
      <div class="livro-views"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/visible.png"/><span>0</span></div>
    </div>

<!-- Sedu√ß√£o Maquiav√©lica -->
    <div class="livro" data-book="seducao-maquiavelica">
      <img src="livros/img/sedu√ßao-maquiavelica.png" alt="Sedu√ß√£o Maquiav√©lica">
      <div class="livro-info">
      <h2>Sedu√ß√£o Maquiav√©lica</h2>
      <p>Domine a arte da sedu√ß√£o e hipnose psicol√≥gica com estrat√©gias sofisticadas e dark.</p>
      <a href="livros/seducao-maquiavelica.html" class="botao">Ver detalhes</a>
    </div>
      <div class="livro-views"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/visible.png"/><span>0</span></div>
    </div>

    </div>

    <!-- Contador total -->
    <div id="total-visits">
      <img src="https://img.icons8.com/ios-glyphs/30/ffffff/visible.png"/>
      <span id="totalVisits">0</span>
    </div>
  </div>

  <!-- Painel Admin -->
  <div id="adminPanel">
    <button id="closeAdmin">Fechar</button>
    <h2>PAINEL ADMIN</h2>
    <div id="adminBooks"></div>
    <div style="margin-top:15px; text-align:center;">
      <button id="resetTotal">Zerar total do site</button>
    </div>
  </div>

  <!-- RODAP√â -->
  <footer>
    <p>¬© 2025 Biblioteca Online</p>
    <p>
      <a href="https://www.aegea.com.br/politica-de-privacidade-e-protecao-de-dados-da-aegea">Pol√≠tica de Privacidade</a> | 
      <a href="https://olist.com/seguranca-e-privacidade/termos-de-uso-loja/?parceiro=1-01-35-01&utm_source=google&utm_campaign=paid-google-tiny-generica-always_on-dsa_dinamica-conv-search-null-keyword&utm_medium=cpc&utm_content=dsa_geral-search-search-dco&utm_term=dsa_geral-search-search-dco_00000308&gad_source=1&gad_campaignid
        =16379307309&gclid=CjwKCAjw_-3GBhAYEiwAjh9fUKKNk-x6Gw1tuwcoVOyTM4xwNEEBMakrnVeFcaAUMfOFNYhc5afijRoCx0wQAvD_BwE">Termos de Uso</a> | 
      <a href="#">Instagram</a> | 
      <a href="https://wa.me/qr/7LPD66PY3ZJ2H1">reclame aqui</a>
    </p>
  </footer>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<!-- GSAP para anima√ß√µes -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.14.1/gsap.min.js"></script>

  <script>
    // CONFIG FIREBASE
    const firebaseConfig = {
      apiKey: "AIzaSyClvq1ZwxUr1ACwXP0esfBbHR95U_QejWI",
      authDomain: "biblioteca-b73c3.firebaseapp.com",
      databaseURL: "https://biblioteca-b73c3-default-rtdb.firebaseio.com",
      projectId: "biblioteca-b73c3",
      storageBucket: "biblioteca-b73c3.firebasestorage.app",
      messagingSenderId: "19441912897",
      appId: "1:19441912897:web:e0a5ecde56a25657db0ac0",
      measurementId: "G-1FPNRPMM9R"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const auth = firebase.auth();

    // CONTADOR TOTAL
    const totalVisitsEl = document.getElementById('totalVisits');
    const totalRef = db.ref('totalVisits');
    totalRef.once('value', snap => { if (!snap.val()) totalRef.set(0); });
    totalRef.on('value', snap => { totalVisitsEl.innerText = snap.val() || 0; });

    if (!sessionStorage.getItem("visited")) {
      totalRef.transaction(current => (current || 0) + 1);
      sessionStorage.setItem("visited", "true");
    }

    // LIVROS
    const livros = document.querySelectorAll('.livro');
    livros.forEach(livro => {
      const key = livro.dataset.book;
      const ref = db.ref('books/' + key);
      ref.once('value', snap => { if (!snap.val()) ref.set(0); });
      const span = livro.querySelector('.livro-views span');
      ref.on('value', snap => { span.innerText = snap.val() || 0; });

      const link = livro.querySelector('.botao');
      const href = link.getAttribute("href");

      link.addEventListener('click', e => {
        e.preventDefault();
        ref.transaction(current => (current || 0) + 1, () => {
          livro.classList.add('flash');
          setTimeout(() => livro.classList.remove('flash'), 3500);
          totalRef.transaction(current => (current || 0) + 1);
          window.location = href;
        });
      });
    });

    // CARROSSEL
    const track = document.getElementById('carousel-track');
    const items = document.querySelectorAll('.carousel-item');
    let currentIndex = 0;

    function updateCarousel() {
      items.forEach(item => item.classList.remove('active'));
      items[currentIndex].classList.add('active');
      const offset = (items[currentIndex].offsetLeft + items[currentIndex].offsetWidth/2) - track.offsetWidth/2;
      track.style.transform = `translateX(${-offset}px)`;
    }

    document.getElementById('prev').addEventListener('click', () => {
      currentIndex = (currentIndex-1+items.length)%items.length;
      updateCarousel();
    });

    document.getElementById('next').addEventListener('click', () => {
      currentIndex = (currentIndex+1)%items.length;
      updateCarousel();
    });

    let startX=0;
    track.addEventListener('touchstart', e => { startX=e.touches[0].clientX; });
    track.addEventListener('touchend', e => {
      let diff=e.changedTouches[0].clientX-startX;
      if(diff>50){ currentIndex=(currentIndex-1+items.length)%items.length; }
      else if(diff<-50){ currentIndex=(currentIndex+1)%items.length; }
      updateCarousel();
    });

    setInterval(()=>{ currentIndex=(currentIndex+1)%items.length; updateCarousel(); },4000);
    updateCarousel();

    // PAINEL ADMIN
    const adminPanel = document.getElementById('adminPanel');
    document.getElementById('closeAdmin').addEventListener('click', ()=>{ adminPanel.style.display='none'; });

    document.addEventListener('keydown', e => {
      if(e.altKey && e.shiftKey && e.key.toLowerCase()=='a'){
        if(!auth.currentUser){
          const email = prompt('Digite seu e-mail de admin:');
          const password = prompt('Digite sua senha de admin:');
          auth.signInWithEmailAndPassword(email,password)
          .then(()=>{ adminPanel.style.display='block'; loadAdminPanel(); })
          .catch(()=>alert('E-mail ou senha incorretos'));
        } else { adminPanel.style.display='block'; loadAdminPanel(); }
      }
    });

    function loadAdminPanel(){
      const adminBooks = document.getElementById('adminBooks');
      adminBooks.innerHTML='';
      livros.forEach(livro=>{
        const key=livro.dataset.book;
        const ref=db.ref('books/'+key);
        const div=document.createElement('div');
        div.className='admin-book';
        div.innerHTML=`
          <span>${livro.querySelector('h2').innerText}: 
            <span id="count-${key}">0</span>
          </span>
          <input type="number" id="input-${key}" min="0" placeholder="N">
          <button id="inc-${key}">+</button>
          <button id="dec-${key}">-</button>
          <button id="set-${key}">Set</button>
          <button id="reset-${key}">Zerar</button>
        `;
        adminBooks.appendChild(div);

        ref.on('value', snap=>{ div.querySelector('#count-'+key).innerText = snap.val() || 0; });

        div.querySelector('#inc-'+key).addEventListener('click', ()=>{ ref.transaction(c => (c||0)+1); });
        div.querySelector('#dec-'+key).addEventListener('click', ()=>{ ref.transaction(c => (c||0)-1); });
        div.querySelector('#reset-'+key).addEventListener('click', ()=>{ ref.set(0); });
        div.querySelector('#set-'+key).addEventListener('click', ()=>{
          const val = parseInt(div.querySelector('#input-'+key).value);
          if(!isNaN(val)) ref.set(val);
        });
      });

      document.getElementById('resetTotal').onclick = ()=>{ totalRef.set(0); };
    }
// ===== ELEMENTOS =====
const searchIcon = document.getElementById("search-icon");
const searchBar = document.getElementById("search-bar");
const searchInput = document.getElementById("search-input");
const livrosLista = document.querySelectorAll(".livro");
const searchResults = document.getElementById("search-results");
const carrossel = document.getElementById("carousel-container");
const categoryBtn = document.getElementById("category-btn");
const categoryMenu = document.getElementById("category-menu");

// ===== CATEGORIAS =====
const categorias = {
  "invisivel": "autoajuda",
  "potencial": "motiva√ß√£o",
  "48leis": "poder",
  "fbi": "psicologia",
  "influenciar-pessoas": "autoajuda",
  "poder-manipulacao": "manipula√ß√£o",
  "engenharia-social": "manipula√ß√£o",
  "manipulacao-oculta": "manipula√ß√£o",
  "seducao-maquiavelica": "estrat√©gia"
};

// ===== FUN√á√ÉO PARA CRIAR CARDS =====
function criarGridLivros(lista) {
  searchResults.innerHTML = "";
  lista.forEach(livro => {
    const titulo = livro.querySelector("h2")?.innerText || "Sem t√≠tulo";
    const imagem = livro.querySelector("img")?.src || "";
    const card = document.createElement("div");
    card.classList.add("card-livro");
    card.innerHTML = `
      <img src="${imagem}" alt="${titulo}">
      <h4>${titulo}</h4>
    `;
    searchResults.appendChild(card);
  });
}

// ===== MOSTRAR GRID =====
function mostrarGrid(livros) {
  livrosLista.forEach(l => l.style.display = "none");
  if (carrossel) carrossel.style.display = "none";
  searchResults.style.display = "grid";
  criarGridLivros(livros);
}

// ===== VOLTAR AO NORMAL =====
function restaurarLayout() {
  searchResults.style.display = "none";
  searchResults.innerHTML = "";
  livrosLista.forEach(l => l.style.display = "flex");
  if (carrossel) carrossel.style.display = "block";
}

// ===== MENU DE CATEGORIAS =====
categoryBtn.addEventListener("click", () => {
  categoryMenu.classList.toggle("active");
});
document.querySelectorAll("#category-menu li").forEach(item => {
  item.addEventListener("click", () => {
    const categoria = item.dataset.category;
    categoryMenu.classList.remove("active");

    if (categoria === "todos") {
      mostrarGrid(Array.from(livrosLista)); // mostra todos os livros em grid
      return;
    }

    const livrosFiltrados = Array.from(livrosLista).filter(livro => {
      const key = livro.dataset.book;
      return categorias[key] === categoria;
    });

    mostrarGrid(livrosFiltrados);
  });
});

// ===== PESQUISA ANIMADA =====

const animatedSVG = `
<svg width="40" height="40" viewBox="0 0 100 100">
  <!-- Lupa -->
  <circle id="lens" cx="40" cy="40" r="20" stroke="white" stroke-width="5" fill="none"/>
  <line id="handle" x1="55" y1="55" x2="75" y2="75" stroke="white" stroke-width="5"/>
  <!-- Casinha -->
  <polygon id="house" points="25,60 50,35 75,60 75,85 25,85" fill="white" scale="0" opacity="0"/>
</svg>
`;
searchIcon.innerHTML = animatedSVG;

let mostrandoPesquisa = false;

searchIcon.addEventListener("click", () => {
  const lens = document.getElementById("lens");
  const handle = document.getElementById("handle");
  const house = document.getElementById("house");

  mostrandoPesquisa = !mostrandoPesquisa;

  if(mostrandoPesquisa){
    searchBar.classList.add("active");
    mostrarGrid(Array.from(livrosLista));
    searchInput.focus();

    // Anima√ß√£o da lupa virando casa
    gsap.to(lens, {duration: 0.5, scale:0.5, transformOrigin:"50% 50%", opacity:0});
    gsap.to(handle, {duration: 0.5, rotate: -45, transformOrigin:"50% 50%", opacity:0});
    gsap.to(house, {duration: 0.5, scale:1, opacity:1, transformOrigin:"50% 50%", delay:0.5});
    
  } else {
    searchBar.classList.remove("active");
    restaurarLayout();
    searchInput.value = "";
    window.scrollTo({ top: 0, behavior: "smooth" });

    // Anima√ß√£o da casa voltando para lupa
    gsap.to(house, {duration:0.5, scale:0, opacity:0});
    gsap.to(lens, {duration:0.5, scale:1, opacity:1, delay:0.5});
    gsap.to(handle, {duration:0.5, rotate:0, opacity:1, delay:0.5});
  }
});

</script>

</body>
</html>












